# Социальная сеть для путешественников - System Design
Домашнее задание для [курса по System Design](https://balun.courses/courses/system_design).

## Функциональные требования:
- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- оценка и комментарии постов других путешественников;
- подписка на других путешественников, чтобы следить за их активностью;
- поиск популярных мест для путешествий и просмотр постов с этих мест в виде ТОПа мест по странам и городам;
- общение с другими путешественниками в личных сообщениях;
- просмотр ленты других путешественников.

## Нефункциональные требования:
- 10 000 000 DAU
    - к концу года
    - линейный рост
- Availability 99.95%
- Каждый пользователь в день:
    - оставляет 5 реакций (оценок + комментариев)
    - подписывается на одного человека
    - отправляет 100 сообщений
    - просматривает 100 постов
- Каждый пользователь ездит куда-либо два раза в год на 2 недели, итого от каждого пользователя 28 постов в год или 0.0767 постов в день
- Нету необходимости в гео-распределении (только СНГ)
- Нету сезонности

## Расчеты

### Размеры сущностей
#### Пост:
- Несколько фотографий (скажем, 5, каждая по 400КБ, итого 2МБ)
- Описание (300 символов юникода - 1.2КБ)
- Локация (4Б)

*Размер: ~2МБ*

#### Пользователь:
- ID пользователя (8Б)
- ФИО (100 символов UTF-8 с кириллицей - 200Б)
- Описание профиля (50 символов UTF-8 - 100Б)
- Аватарка (400КБ)

*Размер: ~401КБ*


#### Комментарий:
- ID автора (8Б)
- Тело (100 символов юникода - 400Б)

*Размер: 408Б*


#### Сообщение
- ID отправителя (8Б)
- ID получателя (8Б)
- Тело (50 символов юникода - 200Б)

*Размер: 216Б*

#### Лайк:
- ID поста (8Б)
- ID пользователя (8Б)

*Размер: 16Б*


#### Подписка:
- ID подписавшегося (8Б)
- ID на кого подписались (8Б)

*Размер: 16Б*


Рассчитаем размеры дисков, которые потребуются на первый год и на следующий. Так как рост линейный, то можем считать, что весь первый год было 5 000 000 DAU.
```
Total requests per user per day = 1 + 5 + 1 + 100 + 250 = 357
RPS = 10 000 000 * 357 / 86 400 ≈ 41 320
Written data per user per day = 2МБ * 0.0767 + 408Б * 3 + 16Б * 2 + 16Б * 1 + 216Б * 100 ≈ 175КБ
Needed write speed = 175КБ * 10 000 000 / 86400 ≈ 20.3 МБ/с
Read data per user per day = 2МБ * 100 = 200МБ
Needed read speed = 200МБ * 10 000 000 / 86400 ≈ 23.2 ГБ/с
Total written data in first year = 175КБ * 5 000 000 * 365 + 401КБ * 10 000 000 ≈ 323ТБ
Total written data in next year = 175КБ * 10 000 000 * 365 ≈ 639ТБ
Replication count = 3
Needed disks (6TB) for storage in first year = 323ТБ * 3 / 6ТБ = 162
Needed disks (6 TB) for storage in next year = 639ТБ * 3 / 6ТБ = 320
Needed disks for read speed (HDD) = 23.2ГБ/с / 0.1ГБ/с = 232
```
Выгоднее взять сразу больше HDD, так как они потребуются в следующем году. Итого, на первый год нам нужно 232 HDD-диска на 6ТБ и еще 250 на следующий (если сохранится число в 10 000 000 DAU).